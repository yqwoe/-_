<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/yqwoe.github.io/theme/img/favicon.ico" >
    <title>
        
            Cas Server 本地部署 &middot; Yq Woe
        
    </title>

    <script src="/yqwoe.github.io/theme/js/jquery-3.2.1.min.js"></script>
    <script src="/yqwoe.github.io/theme/js/popper.min.js"></script>
    <script src="/yqwoe.github.io/theme/js/bootstrap.min.js"></script>

    <link rel="stylesheet" href="/yqwoe.github.io/theme/css/bootstrap.css">
    <link rel="stylesheet" href="/yqwoe.github.io/theme/css/site.css">
    <link rel="stylesheet" href="/yqwoe.github.io/theme/css/syntax.css">
<!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Cas Server 本地部署 | Yq Woe</title>
<meta name="generator" content="Jekyll v3.8.2" />
<meta property="og:title" content="Cas Server 本地部署" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Cas Cas 中心认证服务。Cas是一种面向Web的企业级、多语言单点登录解决方案，它能满足身份验证和授权管理的综合平台 Cas是一种开放优秀的身份验证协议。" />
<meta property="og:description" content="Cas Cas 中心认证服务。Cas是一种面向Web的企业级、多语言单点登录解决方案，它能满足身份验证和授权管理的综合平台 Cas是一种开放优秀的身份验证协议。" />
<link rel="canonical" href="http://localhost:4000/yqwoe.github.io/2018/10/31/SpringBoot_Cas_SSO.html" />
<meta property="og:url" content="http://localhost:4000/yqwoe.github.io/2018/10/31/SpringBoot_Cas_SSO.html" />
<meta property="og:site_name" content="Yq Woe" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-10-31T00:00:00+08:00" />
<script type="application/ld+json">
{"datePublished":"2018-10-31T00:00:00+08:00","url":"http://localhost:4000/yqwoe.github.io/2018/10/31/SpringBoot_Cas_SSO.html","dateModified":"2018-10-31T00:00:00+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/yqwoe.github.io/2018/10/31/SpringBoot_Cas_SSO.html"},"description":"Cas Cas 中心认证服务。Cas是一种面向Web的企业级、多语言单点登录解决方案，它能满足身份验证和授权管理的综合平台 Cas是一种开放优秀的身份验证协议。","@type":"BlogPosting","headline":"Cas Server 本地部署","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

</head>

<style>
    table{
    /* border-left:1px solid #000000;border-top:1px solid #000000; */
    /* width: 100%; */
    /* word-wrap:break-word; word-break:break-all; */
    border: 1px solid #dee2e6;
    width: 100%;
    max-width: 100%;
    margin-bottom: 15px;
    background-color: transparent;
    border-collapse: collapse;
    display: table;
    border-spacing: 2px;
    text-align:center;
  }
  table thead tbody{
  display: table-row-group;
    vertical-align: middle;
    border-color: inherit;
  }
  table tbody tr:nth-of-type(odd) {
    background-color: rgba(0,0,0,0.05);
}
</style>

<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top justify-content-between">
    <a class="navbar-brand font-weight-bold" href="/yqwoe.github.io/index.html">Yq Woe</a>
    <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarContent" >
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarContent">
        <ul class="navbar-nav ml-auto">
                    <li class="nav-item">
                        <a href="http://localhost:4000/feed.xml" class="nav-link">RSS订阅</a>
                    </li>
        
            <li class="nav-item">
                <a href='/yqwoe.github.io/index.html'
                   class="nav-link">
                    主页
                </a>
            </li>
        
            <li class="nav-item">
                <a href='/yqwoe.github.io/about.html'
                   class="nav-link">
                    关于
                </a>
            </li>
        
            <li class="nav-item">
                <a href='/yqwoe.github.io/list/posts.html'
                   class="nav-link">
                    文章
                </a>
            </li>
        
        </ul>
    </div>
</nav>








<div class="container site-container" id="top">
    <div class="row">
        <div class="d-none d-lg-block col-lg-4 col-xl-4 side">
            








    <div class="sticky-top space-before">
    <div class="card bg-light mb-3">
        <div class="card-body">
            <div class="card-title">
                <h5>2018年10月31日</h5>
            </div>
            <div class="d-flex flex-wrap align-items-center">
                <span class="icon grey mr-2 mb-2">
                    <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 18.1.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->

<svg version="1.1" id="Price_tag" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
<g>
	<path d="M19.388,0.405c-0.111-0.314-0.454-0.48-0.769-0.371c-0.315,0.109-0.481,0.455-0.372,0.77
		c0.929,2.67-0.915,4.664-2.321,5.732l-0.568-0.814c-0.191-0.273-0.618-0.5-0.95-0.504L11.22,5.232
		c-0.332-0.006-0.825,0.146-1.097,0.338l-9.394,6.587c-0.455,0.32-0.565,0.947-0.247,1.404l4.269,6.108
		c0.32,0.455,0.831,0.4,1.287,0.082l9.394-6.588c0.27-0.191,0.582-0.603,0.692-0.918l0.998-3.145
		c0.11-0.314,0.043-0.793-0.148-1.066l-0.346-0.496C18.516,6.091,20.476,3.534,19.388,0.405z M15.017,9.763
		c-0.727,0.51-1.731,0.332-2.24-0.396c-0.511-0.73-0.333-1.734,0.395-2.246C13.75,6.716,14.5,6.745,15.04,7.138
		c-0.272,0.164-0.459,0.26-0.494,0.275c-0.301,0.143-0.43,0.504-0.288,0.805c0.104,0.219,0.321,0.348,0.547,0.348
		c0.086,0,0.174-0.02,0.257-0.059c0.194-0.092,0.402-0.201,0.619-0.33C15.778,8.771,15.542,9.394,15.017,9.763z"/>
</g>
</svg>

                </span>
                
                    <a href="/yqwoe.github.io/list/posts.html#spring-boot"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        spring boot
                    </a>
                
                    <a href="/yqwoe.github.io/list/posts.html#cas-client"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        cas client
                    </a>
                
                    <a href="/yqwoe.github.io/list/posts.html#cas-server"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        cas server
                    </a>
                
                    <a href="/yqwoe.github.io/list/posts.html#sso"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        sso
                    </a>
                
            </div>
            <div class="d-flex align-items-center mt-2">
                <span class="icon grey mr-1">
                    <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 18.1.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->

<svg version="1.1" id="Arrow_left" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
<path d="M2.5,10L9,3.5V7h8v6H9v3.5L2.5,10z"/>
</svg>

                </span>
                <a href="/yqwoe.github.io/list/posts.html"> 回到文章 </a>
            </div>
        </div>
    </div>
</div>






        </div>
        <div class="col-md-12 col-lg-8 col-xl-8 pb-4 content">
            <link rel="stylesheet" href="/yqwoe.github.io/static/css/gitment.css">
<script src="/yqwoe.github.io/static/js/gitment.js"></script>
<h1 class="border border-top-0 border-right-0 border-left-0 mb-3 pb-2">Cas Server 本地部署</h1>

<div class="d-md-block d-lg-none">
    <div class="sticky-top space-before">
    <div class="card bg-light mb-3">
        <div class="card-body">
            <div class="card-title">
                <h5>2018年10月31日</h5>
            </div>
            <div class="d-flex flex-wrap align-items-center">
                <span class="icon grey mr-2 mb-2">
                    <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 18.1.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->

<svg version="1.1" id="Price_tag" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
<g>
	<path d="M19.388,0.405c-0.111-0.314-0.454-0.48-0.769-0.371c-0.315,0.109-0.481,0.455-0.372,0.77
		c0.929,2.67-0.915,4.664-2.321,5.732l-0.568-0.814c-0.191-0.273-0.618-0.5-0.95-0.504L11.22,5.232
		c-0.332-0.006-0.825,0.146-1.097,0.338l-9.394,6.587c-0.455,0.32-0.565,0.947-0.247,1.404l4.269,6.108
		c0.32,0.455,0.831,0.4,1.287,0.082l9.394-6.588c0.27-0.191,0.582-0.603,0.692-0.918l0.998-3.145
		c0.11-0.314,0.043-0.793-0.148-1.066l-0.346-0.496C18.516,6.091,20.476,3.534,19.388,0.405z M15.017,9.763
		c-0.727,0.51-1.731,0.332-2.24-0.396c-0.511-0.73-0.333-1.734,0.395-2.246C13.75,6.716,14.5,6.745,15.04,7.138
		c-0.272,0.164-0.459,0.26-0.494,0.275c-0.301,0.143-0.43,0.504-0.288,0.805c0.104,0.219,0.321,0.348,0.547,0.348
		c0.086,0,0.174-0.02,0.257-0.059c0.194-0.092,0.402-0.201,0.619-0.33C15.778,8.771,15.542,9.394,15.017,9.763z"/>
</g>
</svg>

                </span>
                
                    <a href="/yqwoe.github.io/list/posts.html#spring-boot"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        spring boot
                    </a>
                
                    <a href="/yqwoe.github.io/list/posts.html#cas-client"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        cas client
                    </a>
                
                    <a href="/yqwoe.github.io/list/posts.html#cas-server"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        cas server
                    </a>
                
                    <a href="/yqwoe.github.io/list/posts.html#sso"
                       class="bg-white border rounded p-1 mr-2 mb-2 d-inline-block">
                        sso
                    </a>
                
            </div>
            <div class="d-flex align-items-center mt-2">
                <span class="icon grey mr-1">
                    <?xml version="1.0" encoding="utf-8"?>
<!-- Generator: Adobe Illustrator 18.1.1, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->

<svg version="1.1" id="Arrow_left" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
	 viewBox="0 0 20 20" enable-background="new 0 0 20 20" xml:space="preserve">
<path d="M2.5,10L9,3.5V7h8v6H9v3.5L2.5,10z"/>
</svg>

                </span>
                <a href="/yqwoe.github.io/list/posts.html"> 回到文章 </a>
            </div>
        </div>
    </div>
</div>

</div>

<h1 id="cas">Cas</h1>

<blockquote>
  <p><strong><a href="https://github.com/apereo/cas">Cas</a></strong> 中心认证服务。Cas是一种面向Web的企业级、多语言单点登录解决方案，它能满足身份验证和授权管理的综合平台</p>
</blockquote>

<blockquote>
  <p>Cas是一种开放优秀的身份验证协议。</p>
</blockquote>

<!--more-->

<p align="center">
<img src="https://user-images.githubusercontent.com/1205228/30969994-e2fe6bf0-a470-11e7-80f9-d54d1e4d348e.png" />
</p>

<p>我在本地部署的是<strong><a href="https://github.com/apereo/cas-overlay-template">cas-overlay-template</a></strong> 分支5.2</p>

<h2 id="部署cas-server">部署Cas Server</h2>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone https://github.com/apereo/cas-overlay-template.git
<span class="nb">cd </span>cas-overlay-template
git checkout 5.2
mvn package //因为本地jdk1.8 5.2版本支持

<span class="nb">mkdir</span> -p src/main/resources 
<span class="nb">mkdir</span> -p src/main/resources/services
<span class="nb">cp</span> /target/cas/WEB-INF/classes/application.prpperties src/main/resources/application.prpperties
<span class="nb">cp</span> /target/cas/WEB-INF/classes/services/HTTPSandIMAPS-10000001.json src/main/resources/services/HTTPSandIMAPS-10000001.json
</code></pre></div></div>

<h4 id="applicationproperties">application.properties</h4>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">##</span>
<span class="c1"># CAS Server Context Configuration</span>
<span class="c1">#</span>
server.context-path<span class="o">=</span>/cas
server.port<span class="o">=</span>8443

cas.tgc.secure<span class="o">=</span><span class="nb">false  
</span>cas.serviceRegistry.initFromJson<span class="o">=</span><span class="nb">true
</span>server.ssl.enabled<span class="o">=</span><span class="nb">false</span> <span class="c1">#禁用https访问</span>
<span class="c1">#...省略</span>
cas.authn.accept.users<span class="o">=</span>admin::admin <span class="c1">#静态访问用户名密码 admin/admin</span>
</code></pre></div></div>

<h4 id="serviceshttpsandimaps-10000001json">services/HTTPSandIMAPS-10000001.json</h4>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"@class"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"org.apereo.cas.services.RegexRegisteredService"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"serviceId"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"^(https|imaps|http)://.*"</span><span class="p">,</span><span class="w"> </span><span class="err">//增加http访问规则</span><span class="w">
  </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"HTTPS and IMAPS"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"id"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10000001</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"This service definition authorizes all application urls that support HTTPS and IMAPS protocols."</span><span class="p">,</span><span class="w">
  </span><span class="s2">"evaluationOrder"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="w">
</span><span class="p">}</span><span class="w">

</span></code></pre></div></div>

<p>以上操作按照顺序执行</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./build.sh run
</code></pre></div></div>

<p>打开浏览器访问<strong><a href="http://cas.simple.org:8443/cas">http://cas.simple.org:8443/cas</a></strong></p>

<p>Cas Server已经setup起来了。</p>

<p>明天继续更新 Cas Client与Spring boot集成，并实现Cas Server的用户存储数据库。</p>



<div id="container"></div>
<script>
var myTheme = {
  render(state, instance) {
    const container = document.createElement('div')
    container.lang = "zh-CN"
    container.className = 'gitment-container gitment-root-container'
    container.appendChild(instance.renderHeader(state, instance))
    container.appendChild(instance.renderEditor(state, instance))
    container.appendChild(instance.renderComments(state, instance))
    container.appendChild(instance.renderFooter(state, instance))
    return container
  },
}
console.log(location)

var paths = location.pathname.split('/')
console.log(paths)
console.log(decodeURI(paths[paths.length - 1 ]))
var gitment = new Gitment({
    id: decodeURI(paths[paths.length - 1 ]),
  owner: 'yqwoe',
  repo: 'yqwoe.github.io',
  oauth: {
    client_id: '38908a117aeb2426fddb',
    client_secret: 'fab30686c5598f5ba19e726492b27e33e40eceda',
  },
  theme: myTheme
})
gitment.render('container')
</script>
<style>
blockquote{
          font: 14px/22px normal helvetica, sans-serif;
          margin-top: 10px;
          margin-bottom: 10px;
          margin-left: 50px;
          padding-left: 15px;
          padding-top: 10px;
          padding-right: 10px;
          padding-bottom: 10px;
          border-left: 3px solid #ccc;
          background-color:none;
     }
</style>





        </div>
        <div class="col-md-12 d-lg-none bottom">
            

        </div>
    </div>
</div>

<script type="text/javascript">
/*!
 * IE10 viewport hack for Surface/desktop Windows 8 bug
 * Copyright 2014-2017 The Bootstrap Authors
 * Copyright 2014-2017 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */

// See the Getting Started docs for more information:
// https://getbootstrap.com/getting-started/#support-ie10-width

(function () {
    'use strict'

    if (navigator.userAgent.match(/IEMobile\/10\.0/)) {
        var msViewportStyle = document.createElement('style')
        msViewportStyle.appendChild(
            document.createTextNode(
                '@-ms-viewport{width:auto!important}'
            )
        )
        document.head.appendChild(msViewportStyle)
    }
}())
</script>

</body>
<style>
    blockquote{
        display:block;
        background: #fff;
        padding: 15px 20px 15px 45px;
        margin: 0 0 20px;
        position: relative;

        /*字体*/
        font-family: Georgia, serif;
        font-size: 16px;
        line-height: 1.2;
        color: #666;
        text-align: justify;

        /*边框 - (选项)*/
        /*border-left: 15px solid #c76c0c;*/
        /*border-right: 2px solid #c76c0c;*/

        /*盒子阴影 - (选项)*/
        -moz-box-shadow: 2px 2px 15px #ccc;
        -webkit-box-shadow: 2px 2px 15px #ccc;
        box-shadow: 2px 2px 15px #ccc;
    }
    blockquote::before{
        content: "\201C"; /*左双引号的Unicode编码*/

        /*字体*/
        font-family: Georgia, serif;
        font-size: 40px;
        font-weight: bold;
        color: #999;

        /*位置*/
        position: absolute;
        left: 10px;
        top:5px;
    }
    blockquote::after{
        content: ""; /*如果要显示右双引号，则写 content: "\201D"; */
    }


</style>

</html>
